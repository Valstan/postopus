<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PostOpus - –¢–µ—Å—Ç API</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .api-test {
            margin: 20px 0;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 10px;
        }
        .success {
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        .error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }
        .loading {
            background-color: #d1ecf1;
            border-color: #bee5eb;
        }
    </style>
</head>
<body>
    <div class="container mt-5">
        <h1>üß™ –¢–µ—Å—Ç API PostOpus</h1>
        <p class="lead">–ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–±–æ—Ç—É API endpoints</p>
        
        <div class="row">
            <div class="col-md-6">
                <div class="api-test" id="dashboard-test">
                    <h5>üìä Dashboard API</h5>
                    <button class="btn btn-primary" onclick="testDashboard()">–¢–µ—Å—Ç /api/public/dashboard</button>
                    <div id="dashboard-result" class="mt-2"></div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="api-test" id="health-test">
                    <h5>üè• Health Check</h5>
                    <button class="btn btn-success" onclick="testHealth()">–¢–µ—Å—Ç /health</button>
                    <div id="health-result" class="mt-2"></div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-6">
                <div class="api-test" id="info-test">
                    <h5>‚ÑπÔ∏è Info API</h5>
                    <button class="btn btn-info" onclick="testInfo()">–¢–µ—Å—Ç /api/info</button>
                    <div id="info-result" class="mt-2"></div>
                </div>
            </div>
            
            <div class="col-md-6">
                <div class="api-test" id="search-test">
                    <h5>üîç Search API</h5>
                    <button class="btn btn-warning" onclick="testSearch()">–¢–µ—Å—Ç /api/public/search</button>
                    <div id="search-result" class="mt-2"></div>
                </div>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-12">
                <div class="api-test" id="regions-test">
                    <h5>üåç Regions API</h5>
                    <button class="btn btn-secondary" onclick="testRegions()">–¢–µ—Å—Ç /api/public/regions</button>
                    <div id="regions-result" class="mt-2"></div>
                </div>
            </div>
        </div>
        
        <div class="mt-4">
            <a href="/" class="btn btn-outline-primary">‚Üê –í–µ—Ä–Ω—É—Ç—å—Å—è –∫ –¥–∞—à–±–æ—Ä–¥—É</a>
        </div>
    </div>
    
    <script>
        async function testAPI(url, resultId, testName) {
            const resultDiv = document.getElementById(resultId);
            const testDiv = document.getElementById(resultId.replace('-result', '-test'));
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–≥—Ä—É–∑–∫—É
            testDiv.className = 'api-test loading';
            resultDiv.innerHTML = '<div class="spinner-border spinner-border-sm" role="status"></div> –ó–∞–≥—Ä—É–∑–∫–∞...';
            
            try {
                const response = await fetch(url);
                const data = await response.json();
                
                if (response.ok) {
                    testDiv.className = 'api-test success';
                    resultDiv.innerHTML = `
                        <div class="alert alert-success">
                            <strong>‚úÖ –£—Å–ø–µ—à–Ω–æ!</strong><br>
                            <small>–°—Ç–∞—Ç—É—Å: ${response.status}</small><br>
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>
                    `;
                } else {
                    testDiv.className = 'api-test error';
                    resultDiv.innerHTML = `
                        <div class="alert alert-danger">
                            <strong>‚ùå –û—à–∏–±–∫–∞!</strong><br>
                            <small>–°—Ç–∞—Ç—É—Å: ${response.status}</small><br>
                            <pre>${JSON.stringify(data, null, 2)}</pre>
                        </div>
                    `;
                }
            } catch (error) {
                testDiv.className = 'api-test error';
                resultDiv.innerHTML = `
                    <div class="alert alert-danger">
                        <strong>‚ùå –û—à–∏–±–∫–∞ —Å–µ—Ç–∏!</strong><br>
                        <small>${error.message}</small>
                    </div>
                `;
            }
        }
        
        function testDashboard() {
            testAPI('/api/public/dashboard', 'dashboard-result', 'Dashboard');
        }
        
        function testHealth() {
            testAPI('/health', 'health-result', 'Health');
        }
        
        function testInfo() {
            testAPI('/api/info', 'info-result', 'Info');
        }
        
        function testSearch() {
            testAPI('/api/public/search?q=test', 'search-result', 'Search');
        }
        
        function testRegions() {
            testAPI('/api/public/regions', 'regions-result', 'Regions');
        }
        
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç–µ—Å—Ç–∏—Ä—É–µ–º –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            testHealth();
            testInfo();
        });
    </script>
</body>
</html>
